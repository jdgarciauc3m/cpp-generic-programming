\subsection{Return type deduction and references}

\begin{frame}[fragile]{Deducing references}
\begin{lstlisting}
struct X { static int n; }
auto & f() { return X::n; } // int & f()
auto g() { } // void g()
auto & g() { } // Error: void &
\end{lstlisting}

\begin{itemize}
  \pause 
  \item Rules for \cppkey{decltype} and \cppkey{auto} are different.
    \begin{itemize}
      \item A return type \cppkey{decltype(auto)} chooses \cppkey{decltype}
            instead of \cppkey{auto} rules.
    \end{itemize}
\end{itemize}

\begin{lstlisting}
int & f();
auto g() { return f(); } // int g()
decltype(auto) h() { return f(); } // int & h()
\end{lstlisting}

\begin{itemize}
  \pause
  \item Deducing references with trailing return type in lambdas.
\end{itemize}
\begin{lstlisting}
int f();
[]()->auto & { return f(); } // int &
\end{lstlisting}
\end{frame}
